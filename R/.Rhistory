? lm
library('openxlsx')
library('dplyr')
library('ggplot2')
library('reshape2')
data.path <- '../data/'
raw.data <- read.xlsx(paste0(data.path,'AVM_DSA_Update_EPIE_DBER.xlsx'),sheet = 1)
#kick out Nan columns
clean.data <- raw.data[,-c(1,2,3,4,5,8,9,10,11,12,13,19,22,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,76,77)]
library('corrplot')
num.data <- as.data.frame(sapply(clean.data,as.numeric))
#sapply(num.data,is.numeric)
data.cor <- cor(num.data,use = 'pairwise.complete.obs')
png('CorPlot.png', width = 2000, height = 2000)
corrplot(data.cor,method = 'circle')
dev.off()
fit <- lm(Volume.of.Hemorrhage.(ml) ~ ., clean.data)
fit <- lm(`Volume.of.Hemorrhage.(ml)` ~ . , clean.data)
summary(fit)
fit <- lm(`Volume.of.Hemorrhage.(ml)` ~ . , clean.data)
summary(fit)
View(clean.data)
fit <- lm(`Volume.of.Hemorrhage.(ml)` ~ . , clean.data, na.action = na.exclude)
summary(fit)
fit <- lm(`Volume.of.Hemorrhage.(ml)` ~ . , clean.data, na.action = na.omit)
summary(fit)
? write.csv
write.csv(clean.data, file = paste0(data.path,'Clean_data.csv'))
